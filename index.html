<!doctype html>
<html>
  <head>
    <title>Web BCSFE</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@4.15.0/css/xterm.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/xterm@4.15.0/lib/xterm.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <style>
      body {
        background-color: #1e1e1e;
        color: #fff;
        font-family: sans-serif;
        margin: 0;
        padding: 0;
      }
      #container {
        display: flex;
        height: 100vh;
      }
      #terminal-container {
        flex: 7;
      }
      #terminal {
        width: 100%;
        height: 100%;
      }
      #upload-container {
        flex: 1;
        padding: 20px;
        background-color: #252526;
        border-left: 1px solid #333;
      }
      h2 {
        margin-top: 0;
      }
      input[type="file"] {
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <div id="container">
      <div id="terminal-container">
        <div id="terminal"></div>
      </div>
      <div id="upload-container">
        <h2>Upload File</h2>
        <form id="upload-form">
          <input type="file" id="file-input" required />
          <button type="submit">Upload</button>
        </form>
        <p id="upload-status"></p>
      </div>
    </div>
    <script>
      const term = new Terminal({ theme: { background: '#1e1e1e' } });
      term.open(document.getElementById('terminal'));
      const socket = io();

      socket.on('terminal-output', (data) => {
        term.write(data);
      });

      term.onData((data) => {
        socket.emit('terminal-input', data);
      });

      const uploadForm = document.getElementById('upload-form');
      const fileInput = document.getElementById('file-input');
      const uploadStatus = document.getElementById('upload-status');

      uploadForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const file = fileInput.files[0];
        if (!file) {
          uploadStatus.textContent = 'Please select a file.';
          return;
        }

        const formData = new FormData();
        formData.append('file', file);

        uploadStatus.textContent = 'Uploading...';

        fetch(`/upload?socketId=${socket.id}`, {
          method: 'POST',
          body: formData,
        })
        .then(response => response.text())
        .then(data => {
          uploadStatus.textContent = data;
          fileInput.value = '';
        })
        .catch(error => {
          console.error('Error uploading file:', error);
          uploadStatus.textContent = 'Error uploading file.';
        });
      });
    </script>
  </body>
</html>